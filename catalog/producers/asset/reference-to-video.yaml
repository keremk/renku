meta:
  name: Reference-to-Video Generator
  description: Generate video using reference images/videos for subject consistency.
  id: ReferenceToVideoProducer
  version: 0.1.0
  author: Renku
  license: MIT

inputs:
  - name: Prompt
    description: Text description of the video.
    type: string
  - name: NegativePrompt
    description: What to avoid in the video.
    type: string

  # References
  - name: ReferenceImages
    description: Reference images for consistent subject appearance.
    type: collection
    itemType: image
  - name: ReferenceVideos
    description: Reference videos for subject consistency.
    type: collection
    itemType: video

  # Duration
  - name: Duration
    description: Video duration in seconds.
    type: integer

  # Sizing
  - name: AspectRatio
    description: "Aspect ratio (16:9, 9:16, 1:1, 4:3, 3:4)."
    type: string
  - name: Resolution
    description: "Resolution preset (720p, 1080p)."
    type: string

  # Audio
  - name: GenerateAudio
    description: Whether to generate audio.
    type: boolean

  # Generation control
  - name: Seed
    description: Random seed for reproducibility.
    type: integer
  - name: EnhancePrompt
    description: Enable prompt enhancement.
    type: boolean
  - name: MultiShots
    description: Enable multi-shot segmentation.
    type: boolean
  - name: AutoFixPrompt
    description: Auto-fix prompts failing content policy.
    type: boolean

artifacts:
  - name: GeneratedVideo
    description: The generated video.
    type: video

mappings:
  fal-ai:
    # Wan v2.6 Reference-to-Video (uses video references)
    wan/v2.6/reference-to-video:
      Prompt: prompt
      NegativePrompt: negative_prompt
      ReferenceVideos: video_urls
      Duration:
        field: duration
        intToString: true
      AspectRatio: aspect_ratio
      Resolution: resolution
      Seed: seed
      EnhancePrompt: enable_prompt_expansion
      MultiShots: multi_shots

    # Veo 3.1 Reference-to-Video (uses image references)
    veo3.1/reference-to-video:
      Prompt: prompt
      ReferenceImages: image_urls
      Duration:
        field: duration
        intToSecondsString: true
      Resolution: resolution
      GenerateAudio: generate_audio
      AutoFixPrompt: auto_fix
