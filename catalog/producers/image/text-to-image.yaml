meta:
  name: Text-to-Image Generator
  description: Generate images from text prompts using various AI models.
  id: TextToImageProducer
  kind: producer
  version: 0.1.0
  author: Renku
  license: MIT

inputs:
  - name: Prompt
    description: Text description of the image to generate.
    type: string

  # Sizing
  - name: AspectRatio
    description: "Aspect ratio (16:9, 9:16, 1:1, 4:3, 3:4, 3:2, 2:3, 21:9, 4:5, 5:4)."
    type: string
  - name: Resolution
    description: "Resolution preset (1K, 2K, 4K)."
    type: string
  - name: Width
    description: Custom width in pixels.
    type: integer
  - name: Height
    description: Custom height in pixels.
    type: integer

artifacts:
  - name: GeneratedImage
    description: The generated image(s).
    type: image

mappings:
  fal-ai:
    # Pattern 4: image_size presets
    bytedance/seedream/v4.5/text-to-image:
      Prompt: prompt
      # AspectRatio + Resolution combine into image_size
      ImageSize:
        field: image_size
        combine:
          inputs: [AspectRatio, Resolution]
          table:
            # Resolution only (aspect determined by resolution)
            "+2K": auto_2K
            "+4K": auto_4K
            # AspectRatio only (default resolution)
            "16:9+": landscape_16_9
            "9:16+": portrait_16_9
            "4:3+": landscape_4_3
            "3:4+": portrait_4_3
            "1:1+": square_hd
            # Both specified - prefer resolution auto modes
            "16:9+2K": auto_2K
            "16:9+4K": auto_4K
            "1:1+2K": auto_2K
            "1:1+4K": auto_4K

    bytedance/seedream/v4/text-to-image:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd
          "3:2": landscape_4_3
          "2:3": portrait_4_3

    # Pattern 1: aspect_ratio only
    flux-pro/kontext/text-to-image:
      Prompt: prompt
      AspectRatio: aspect_ratio
      # Resolution ignored - model doesn't support it

    # Pattern 5: Fixed dimension strings
    gpt-image-1.5:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "1:1": "1024x1024"
          "16:9": "1536x1024"
          "9:16": "1024x1536"
          # Other ratios not supported - error or default
      # Resolution ignored - only fixed sizes

    # Pattern 2: aspect_ratio + resolution
    nano-banana-pro:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: resolution
      # Both pass through directly

    # Pattern 4: image_size presets
    qwen-image-2512:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd
          "3:2": landscape_4_3
          "2:3": portrait_4_3
      # Resolution: use image_size object form (expands width/height into payload)
      ImageSize:
        conditional:
          when:
            input: Resolution
            notEmpty: true
          then:
            expand: true
            combine:
              inputs: [AspectRatio, Resolution]
              table:
                "16:9+1K": { width: 1920, height: 1080 }
                "16:9+2K": { width: 2560, height: 1440 }
                "1:1+1K": { width: 1024, height: 1024 }
                "1:1+2K": { width: 2048, height: 2048 }

    wan/v2.6/text-to-image:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    hunyuan-image/v3/instruct/text-to-image:
      Prompt: prompt
      # AspectRatio preset - only applied when Width is not provided
      AspectRatio:
        conditional:
          when:
            input: Width
            empty: true
          then:
            field: image_size
            transform:
              "16:9": landscape_16_9
              "9:16": portrait_16_9
              "4:3": landscape_4_3
              "3:4": portrait_4_3
              "1:1": square_hd
      # Custom dimensions via Width/Height (takes precedence over AspectRatio)
      Width:
        conditional:
          when:
            input: Width
            notEmpty: true
          then:
            field: image_size.width
      Height:
        conditional:
          when:
            input: Width
            notEmpty: true
          then:
            field: image_size.height

    xai/grok-imagine-image:
      Prompt: prompt
      AspectRatio: aspect_ratio

    # Flux 2 family — image_size presets
    flux-2:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    flux-2/flash:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    flux-2/turbo:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    # Recraft v4 — image_size presets
    recraft/v4/text-to-image:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    recraft/v4/pro/text-to-image:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

    # Z-Image Turbo — image_size presets
    z-image/turbo:
      Prompt: prompt
      AspectRatio:
        field: image_size
        transform:
          "16:9": landscape_16_9
          "9:16": portrait_16_9
          "4:3": landscape_4_3
          "3:4": portrait_4_3
          "1:1": square_hd

  replicate:
    # Bytedance Seedream 4
    bytedance/seedream-4:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: size
      Width: width
      Height: height

    # Bytedance Seedream 4.5
    bytedance/seedream-4.5:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: size
      Width: width
      Height: height

    # Google Nano Banana
    google/nano-banana:
      Prompt: prompt
      AspectRatio: aspect_ratio

    # Pattern 1: aspect_ratio only
    google/imagen-4:
      Prompt: prompt
      AspectRatio: aspect_ratio
      # Only supports: 1:1, 9:16, 16:9, 3:4, 4:3
      # Resolution ignored

    # Pattern 7: Width/Height only
    prunaai/z-image-turbo:
      Prompt: prompt
      Width: width
      Height: height
      # For users who specify AspectRatio + Resolution (expands width/height into payload)
      ImageSize:
        conditional:
          when:
            input: Width
            empty: true
          then:
            expand: true
            combine:
              inputs: [AspectRatio, Resolution]
              table:
                "16:9+1K": { width: 1024, height: 576 }
                "9:16+1K": { width: 576, height: 1024 }
                "1:1+1K": { width: 1024, height: 1024 }
                "16:9+": { width: 1024, height: 576 }
                "1:1+": { width: 1024, height: 1024 }

    # Flux 2 Pro — aspect_ratio + resolution (megapixels)
    black-forest-labs/flux-2-pro:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: resolution
      Width:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: width
      Height:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: height

    # Flux 2 Max — same as Pro
    black-forest-labs/flux-2-max:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: resolution
      Width:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: width
      Height:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: height

    # Flux 2 Klein 9B — aspect_ratio + megapixels
    black-forest-labs/flux-2-klein-9b:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution: megapixels

    # Recraft v4 — aspect_ratio + size
    recraft-ai/recraft-v4:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Resolution:
        field: size
        transform:
          "1K": "1024x1024"
          "2K": "2048x2048"

    # XAI Grok Imagine Image — aspect_ratio only
    xai/grok-imagine-image:
      Prompt: prompt
      AspectRatio: aspect_ratio

    # PrunaAI P-Image — aspect_ratio + width/height
    prunaai/p-image:
      Prompt: prompt
      AspectRatio: aspect_ratio
      Width:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: width
      Height:
        conditional:
          when:
            input: AspectRatio
            equals: custom
          then:
            field: height

  wavespeed-ai:
    # Bytedance SeedDream v4.5 — size as WxH string
    bytedance/seedream-v4.5:
      Prompt: prompt
      Resolution:
        field: size
        transform:
          "1K": "1024*1024"
          "2K": "2048*2048"
          "4K": "4096*4096"
